</details>

******

<details>
<summary>Exercise 1: Linux Mint Virtual Machine </summary>
 <br />

Download Page
- https://linuxmint.com/download.php

Installation Guide
- https://linuxmint-installation-guide.readthedocs.io/en/latest/

If you have any issues creating the VM locally, you can use this free online VM platform to get access to Linux Mint
- https://www.onworks.net/component/content/article?id=65735:free-linux-mint-online

_Just click on "run online" and it will spin up a new Mint OS machine for you_

</details>

******

<details>
<summary>Exercise 2: Bash Script - Install Java </summary>
 <br />

**script:**
```sh
#!/bin/bash

apt update
apt install -y default-jre

java_version=$(java -version 2>&1 > /dev/null  | grep "java version\|openjdk version" | awk '{print substr($3,2,2)}')

if [ "$java_version" == "" ]
then
    echo Installing Java has failed. No java version found	
elif [ "$java_version" == "1." ]
then
    echo An old version of Java installation found
elif [ "$java_version" -ge 11 ]
then
    echo Java version 11 or greater installed successfully
fi
```

Execute script with sudo!

Breakdown of command that gets java version:
- `java -version` gives you the complete version output.
- `2>&1 > /dev/null` addition does following things: with `2>&1` the error output of the `java -version` command will be discarded by the `/dev/null` file, and `>` redirects the output of `java -version` command to the `/dev/null` file, which is a special type of file, that accepts and discards all input written to it. So described together, this option takes the output, including any errors generated by the `java -version` command and discards it, not showing it on the command-line and silently forwarding it using `|` (pipe) to the next command, which is `grep "java version\|openjdk version"`
- `grep "java version\|openjdk version"` simply finds a line in the output that has "java version" or "openjdk version" in it. The example line will look like this: openjdk version "11.0.16" 2022-07-19
- `awk '{print substr($3,2,2)}` takes the line from the previous output and grabs the third section of the string "11.0.16" and from there grabs the first 2 characters, which will be "11"


*Detailed explanation of `2>&1`:

Every time, we execute a program or a command, operating system opens three files: **standard input**, **standard output**, and **standard error**, and each file gets a file descriptor integer from the OS: 0, 1, and 2, respectively. So 2>&1 simply says redirect standard error (2) to standard output (1). The `&` before `1` in this case, means whatever follows is a file descriptor, not a filename. 

Explanation of `if else` script:
- In the if else checks, we check if the $java_version variable has no value at all or empty value, it means we have no java installation at all
- If you have an older version of java already installed, like 1.6, 1.7, 1.8, then the value of `"$java_version"` will be `"1."` - first 2 characters. So with `"$java_version" == "1."`, we check whether `java_version` variable is `"1."`. This means installing latest java version was not successful, since you still have only the old version.
- In case of success you should get java version which is 11 or higher (`"$java_version" -ge 11`), which will print success message.


</details>

******

<details>
<summary>Exercise 3, 4, 5: Bash Script - User Processes Sorted </summary>
 <br />

**script  :**
```sh
#!/bin/bash

echo -n "Would you like to sort the processes output by memory or CPU? (m/c) "
read sortby
echo -n "How many results do you want to display? "
read lines

if [ "$sortby" = "m" ]
then
    ps aux --sort -rss | grep -i `whoami` | head -n "$lines"
elif [ "$sortby" = "c" ]
then
    ps aux --sort -%cpu | grep -i `whoami` | head -n "$lines"
else
    echo "No input provided. Exiting"
fi
```

</details>

******

<details>
<summary>Exercise 6, 7: Start NodeJs App </summary>
 <br />

**script**
```sh
#!/bin/bash

# prepare environment, install all tools
apt update

echo "install node, npm, curl, wget, net-tools"
apt install -y nodejs npm curl net-tools  
sleep 15
echo ""
echo "################"
echo ""

# read user input for log directory
echo -n "Set log directory location for the application (absolute path): "
read LOG_DIRECTORY
if [ -d $LOG_DIRECTORY ]
then
  echo "$LOG_DIRECTORY already exists"
else
  mkdir -p $LOG_DIRECTORY
  echo "A new directory $LOG_DIRECTORY has been created"
fi

# display nodeJS version
node_version=$(node --version)
echo "NodeJS version $node_version installed"

# display npm version
npm_version=$(npm --version)
echo "NPM version $npm_version installed"

echo ""
echo "################"
echo ""

# fetch NodeJS project archive from s3 bucket
wget https://node-envvars-artifact.s3.eu-west-2.amazonaws.com/bootcamp-node-envvars-project-1.0.0.tgz

# extract the project archive to ./package folder
tar zxvf ./bootcamp-node-envvars-project-1.0.0.tgz

# set all needed environment variables
export APP_ENV=dev
export DB_PWD=mysecret
export DB_USER=myuser 

# change to package directory
cd package

# install application dependencies
npm install

# start the nodejs application in the background
node server.js &

# display that nodejs process is running
ps aux | grep node | grep -v grep

# display that nodejs is running on port 3000
netstat -ltnp | grep :3000
```

</details>

******

<details>
<summary>Exercise 8, 9: Start NodeJs App with Service user & Log Directory </summary>
 <br />

**script**
```sh
#!/bin/bash

# prepare environment, install all tools
apt update
NEW_USER=myapp

echo "install node, npm, curl, wget, net-tools"
apt install -y nodejs npm curl net-tools  
sleep 15
echo ""
echo "################"
echo ""

# read user input for log directory
echo -n "Set log directory location for the application (absolute path): "
read LOG_DIRECTORY
if [ -d $LOG_DIRECTORY ]
then
  echo "$LOG_DIRECTORY already exists"
else
  mkdir -p $LOG_DIRECTORY
  echo "A new directory $LOG_DIRECTORY has been created"
fi

# display nodeJS version
node_version=$(node --version)
echo "NodeJS version $node_version installed"

# display npm version
npm_version=$(npm --version)
echo "NPM version $npm_version installed"

echo ""
echo "################"
echo ""

# create new user to run the application and make owner of log dir
useradd $NEW_USER -m
chown $NEW_USER -R $LOG_DIRECTORY

# executing the following commands as new user using 'runuser' command

# fetch NodeJS project archive from s3 bucket
runuser -l $NEW_USER -c "wget https://node-envvars-artifact.s3.eu-west-2.amazonaws.com/bootcamp-node-envvars-project-1.0.0.tgz"

# extract the project archive to ./package folder
runuser -l $NEW_USER -c "tar zxvf ./bootcamp-node-envvars-project-1.0.0.tgz"

# start the nodejs application in the background, with all needed env vars with new user myapp
runuser -l $NEW_USER -c "
    export APP_ENV=dev && 
    export DB_PWD=mysecret && 
    export DB_USER=myuser && 
    export LOG_DIR=$LOG_DIRECTORY && 
    cd package && 
    npm install && 
    node server.js &"

# display that nodejs process is running
ps aux | grep node | grep -v grep

# display that nodejs is running on port 3000
netstat -ltnp | grep :3000
```

Execute script with sudo command

</details>

******
